---
title: Implementation_Revision_Policy
version: v0.1
project: gov-llm-e2e-testkit
doc_type: implementation-policy
scope: 工程5（実装修正方針・実装修正計画・工程完結）
status: drafting
date: 2026-01-11

related_docs:
  - docs/test_plan/test_plan_v0.2.0.md
  - docs/test_plan/impl_diff_review_v0.2.0.md

principles:
  - design-first
  - decision-with-evidence
  - no-rejudgement
  - implementation-reflection
---

## 工程5：実装修正方針・実装修正計画（完結工程）

## 1. 本書の目的と工程5の位置づけ

### 1.1 本書の目的

本書は、工程4において確定した  
**設計と実装の差分判断（A / B / C 判定）および pytest 責務の線引き**を入力正本として、

- pytest に残す責務
- pytest から除外する責務
- それらを反映したテストスイート全体の整理結果

を、**実装修正として反映するための方針および計画を明文化する**ことを目的とする。

工程4では、  
「どの差分を修正対象とするか」  
「どの責務を pytest に置かないか」  
といった判断が、設計根拠付きで確定している。

本書は、それらの判断を**再評価・再裁定することなく**、  
実装上の変更として正しく反映し、  
テスト工程環境を **整理済みの安定状態** に到達させるための文書である。

したがって本書は、

- 差分レビュー文書ではない
- 新たな設計判断を行う文書ではない
- テスト改善や最適化を提案する文書ではない

あくまで、**確定済み判断を実装に反映する工程（工程5）を完結させるための作業指針**として位置づけられる。

---

### 1.2 工程5の完了定義

工程5は、以下の条件をすべて満たした状態に到達したとき、  
**完了したものとして扱う**。

- pytest 上に存在する各テストの責務が、  
  test_plan_v0.2.0 および impl_diff_review_v0.2.0 に基づき整理済みであること
- B判定とされたテストに対し、  
  削除・縮退・移動等の **実装修正が完了していること**
- テストスイート全体が、  
  「整理後の正」として pytest 実行環境上で成立していること
- CHANGELOG.md および PROJECT_STATUS.md が、  
  工程5完了状態を反映した内容に更新されていること
- 本書末尾に定義された **工程5 作業チェックリスト** が、  
  すべて完了状態になっていること

これらを満たした状態において、  
本プロジェクトは **テスト計画再構築Backlog上の工程5を完了し、  
通常の開発・検証フェーズへ復帰可能な状態にある** と判断する。

---

## 2. 工程5の前提条件（再判断しない事項）

本章は、工程5における作業範囲を明確に限定するため、  
**本工程の開始時点で既に確定している事項**と、  
**本工程では扱わない事項**を整理するものである。

ここに記載された前提条件に反する判断・作業は、  
工程5のスコープ外とする。

---

### 2.1 入力正本

工程5において参照する設計上の正本は、以下の2点に限定される。

- `test_plan_v0.2.0`
- `impl_diff_review_v0.2.0`

  - 特に、第6章「横断的に見えた傾向と注意点」以降の整理内容

これらの文書は、工程4までに  
設計上の判断および差分裁定が確定した成果物であり、  
工程5では **入力として参照するのみ** とする。

他の設計書、過去バージョンのテスト計画、  
運用慣習や実装履歴は、  
工程5における判断根拠としては使用しない。

---

### 2.2 工程4で確定している事項（事実）

工程4において、以下の事項はすでに確定している。

- 全 test file について、  
  **A / B / C の判定が付与されていること**
- B判定群について、  
  設計逸脱の性質に基づき  
  **逸脱タイプ別（B-α / B-β / B-γ）に再分類されていること**
- pytest に残す責務と、
  pytest から除外する責務の線引きが  
  設計根拠付きで確定していること
- 各テストについて、  
  「残す」「縮退する」「外す」という  
  **最終的な処遇が確定していること**

これらはすべて  
`impl_diff_review_v0.2.0` において事実として記録されており、  
工程5では **再検討・再裁定の対象とはならない**。

---

### 2.3 本工程で行わないこと

工程5では、以下の作業・判断を行わない。

- 差分判断（A / B / C 判定）の再実施
- pytest が担う責務の再定義・再整理
- テストの網羅性向上や品質改善を目的とした最適化提案
- 新たな設計方針の導入や既存設計の是非検討

工程5は、  
**「判断を行う工程」ではなく、  
「確定した判断を実装に反映する工程」**である。

したがって、  
判断の追加や設計変更につながる作業は、  
本工程のスコープ外とする。

---

## 3. 工程5における実装修正の基本原則（設計拘束）

本章では、工程5における実装修正を行う際に  
**必ず遵守すべき設計上の拘束条件**を明文化する。

これらの原則は、  
工程4で確定した pytest の責務線引きを  
**実装段階で破壊しないための制約**であり、  
工程5の作業効率や実装容易性よりも優先される。

---

### 3.1 修正の基本方針（FIX）

工程5における実装修正は、  
以下の基本方針に従って行う。

- pytest は、  
  **契約の成立確認、実行フローの成立確認、  
  および構造的な保証**のみを担う
- pytest の pass / fail 判定は、  
  「実行できたか」「必要な構造が存在するか」  
  といった **機械的に二値化可能な事実**に限定される
- 回答内容の妥当性や十分性、  
  プロファイル間の差異、  
  評価結果の良否といった判断は、  
  pytest の責務には含めない

これらは、  
`test_plan_v0.2.0` および  
`impl_diff_review_v0.2.0` において  
すでに確定した責務分離を、  
**実装面で忠実に反映するための固定方針**である。

工程5では、この方針を前提としてのみ  
削除・縮退・移動といった実装修正を行う。

---

### 3.2 明示的禁止事項

工程5における実装修正では、  
以下の行為を **明示的に禁止**する。

- 応答内容の正しさや十分性を判定するための  
  **意味評価 assertion の追加**
- 既存テストに対し、  
  合格条件を厳密化・高度化することによる  
  **pytest 責務の再拡張**
- pytest を  
  評価主体・品質判断主体として扱う修正、  
  またはそのように振る舞わせる変更

これらはすべて、  
工程4で確定した設計判断に対する  
**逆行的な変更**となり、  
工程5の目的と矛盾する。

工程5は、  
「pytest をより賢くする工程」ではなく、  
**pytest を契約保証装置として純化する工程**である。

したがって、  
一見すると有用に見える変更であっても、  
上記禁止事項に該当する場合は  
本工程では実施しない。

---

## 4. 実装修正対象の確定（作業スコープ）

本章では、工程5において実施する実装修正の対象を、  
**削除・縮退・維持**の三区分で整理する。

ここで示す分類は、  
工程4において確定した差分判断および責務線引きを  
**作業スコープとして再掲するもの**であり、  
工程5において新たな判断を行うものではない。

---

### 4.1 削除対象（pytest から完全除外）

以下に該当するテスト群は、  
工程5において **pytest の実行対象から完全に除外**する。

- Legacy ask 系テスト ほか、  
  pytest による自動実行・合否判定を前提としていないテスト

これらのテストは、

- pytest の責務として定義された  
  契約・成立・構造保証と整合しない
- 実行結果が意味評価・品質評価に依存しており、  
  pytest に残すことで責務逸脱を再発させる

といった理由から、  
工程4において削除対象として確定している。

工程5では、  
これらを pytest の管理下に残したまま整理・縮退することは行わず、  
**テストファイル単位での削除または隔離**をもって対応する。

---

### 4.2 縮退対象（pytest に残すが責務縮小）

以下のテスト群は、  
pytest に残すものの、  
担う責務を **契約・成立・構造保証のみに縮小**する。

- F4 writer 系テスト
- Basic / Advanced RAG v0.1 系テスト

これらは、工程4において

- テストの存在意義自体は否定されていない
- ただし、現在の実装では  
  pytest の責務を超える評価や比較を含んでいる

と判断されたテスト群である。

工程5では、

- 意味評価や品質評価に該当する assertion を除去し
- pytest が担うべき最小責務のみを残す

という **縮退（Reduce）** を行うことで、  
pytest 上のテストとして存続させる。

---

### 4.3 維持対象（No Action）

以下のテスト群については、  
工程5において **実装修正の対象とはしない**。

- Gate 系テスト
- F9-A 系テスト
- Diagnostic 系テスト

これらは、

- pytest の責務定義と整合している
- 工程4においても差分逸脱が確認されていない

ことから、  
工程5では **現状維持（No Action）** とする。

工程5における作業は、  
これらのテストに影響を与えないことを前提として進める。

---

※ 各テストがどの区分に属するかという  
**個別対応の根拠および一覧**は、  
`impl_diff_review_v0.2.0` 第6章に記載された整理結果を正本とし、  
本章では重複して記載しない。

---

## 5. 実装修正の型（許容される修正方法）

本章では、工程5において許容される  
**実装修正の方法（修正の型）**を定義する。

工程5における実装修正は、  
工程4で確定した判断を反映するためのものであり、  
修正方法の自由度を広げることを目的としない。

したがって、本章に定義された型以外の修正は、  
原則として工程5では行わない。

---

### 5.1 削除（Delete）

**削除（Delete）** は、  
対象となるテストを pytest の実行対象から  
**完全に除外する** 修正方法である。

削除は、以下のいずれかの形で行う。

- pytest が収集するテストファイルからの削除
- pytest の探索対象外となる場所へのファイル単位での隔離

削除対象となるテストは、  
工程4において

- pytest の責務と構造的に整合しない
- pytest に残すことで責務逸脱を再発させる

と判断されたものであり、  
工程5では **部分的な修正や縮退は行わない**。

削除は、  
pytest における責務境界を明確化するための  
**最も強い修正手段**として位置づけられる。

---

### 5.2 縮退（Reduce）

**縮退（Reduce）** は、  
テスト自体は pytest に残しつつ、  
担う責務を **最小構成に縮小する** 修正方法である。

縮退対象となるテストでは、  
以下の対応を行う。

- 応答内容の妥当性・十分性・差異を評価する  
  **意味評価 assertion の削除**
- テスト実行が成立していること
- 必要な構造・成果物が存在していること
- 例外により実行フローが破壊されていないこと

といった、  
**存在・構造・非例外確認のみを残す**

縮退は、  
テストの存在意義を維持しつつ、  
pytest の責務を逸脱させないための  
**調整的な修正手段**である。

---

### 5.3 移動（Relocate）

**移動（Relocate）** は、  
テストや検証コードを pytest の管理下から外し、  
別の役割を持つ領域へ移設する修正方法である。

移動先としては、以下を想定する。

- Evaluation Artifacts
- docs
- scripts

移動にあたっては、

- pytest から当該コードが import・参照されないこと
- pytest 実行結果に影響を与えないこと

を必ず確認する。

移動は、  
「削除するほどではないが、  
pytest に置くべきではない」  
資産を整理するための手段であり、  
工程5における責務分離を  
**構造として固定する役割**を持つ。

---

本章で定義した三つの修正の型は、  
工程5におけるすべての実装修正を  
**網羅的に包含する**。

以降の章では、  
これらの型を前提として、

- pytest マーカーの整理
- 特定資産（F4 trial dataset）の除去
- 工程5完了条件の確認

といった作業を具体化していく。

---

## 6. pytest マーカーおよび実行構成の整理

本章では、工程5において実施する  
pytest マーカーおよび実行構成の整理について、  
**目的・範囲・制約**を明確にする。

ここで扱うマーカー整理は、  
テストの意味付けや評価軸を追加するものではなく、  
工程4で確定した pytest の責務線引きを  
**実行構成として反映するための作業**に限定される。

---

### 6.1 マーカー整理方針

工程5における pytest マーカー整理は、  
以下の方針に基づいて行う。

- テストが担う責務を、  
  **contract / behavior / diagnostic** の区分として明示する
- CI において実行すべきテスト範囲を、  
  マーカーを用いて整理する

これらの区分は、  
pytest に新たな意味論や評価基準を導入するためのものではなく、  
**実行対象の制御および責務の可視化**を目的とする。

マーカーは、  
テストの「良し悪し」や「期待水準」を表現するものではなく、  
**実行時の取り扱いを機械的に分岐するための情報**としてのみ使用する。

---

### 6.2 実装修正時の注意点

pytest マーカーおよび実行構成の整理にあたっては、  
以下の点に留意する。

- テストの **実行順序** は変更しない
- 既存の **skip 条件** は原則として変更しない
- マーカーに、  
  意味評価・品質評価・合格基準といった  
  **意味論を持ち込まない**

これらは、  
工程5が「テストの振る舞いを変える工程」ではなく、  
**テストの役割を整理する工程**であることを  
担保するための制約である。

マーカー整理の結果として、  
pytest の実行対象や CI 上の構成が明確化されることは許容されるが、  
テスト結果の意味づけが変化するような修正は行わない。

---

## 7. F4 trial dataset の pytest からの完全除去

本章では、工程5において実施する  
**F4 trial dataset の pytest からの完全除去**について整理する。

この対応は、  
工程4において確認された pytest 責務逸脱を是正し、  
テストスイート全体を  
**契約保証基盤として整理するための必須作業**である。

---

### 7.1 除去対象

工程5において、  
以下の資産は pytest の管理下から除去する。

- F4 trial dataset 本体
- pytest の assertion に直接・間接的に含まれる  
  派生 JSON / Markdown 等の成果物

これらは、  
試行的・検証的なデータとしては有用である一方で、

- pytest における pass / fail 判定が  
  意味評価や内容比較に依存する
- 実行条件やナレッジ差分によって  
  結果が不安定になりやすい

といった特性を持ち、  
pytest の責務定義と整合しない。

そのため工程5では、  
**これらを pytest の assertion 対象として扱わない**  
という判断を実装修正として反映する。

---

### 7.2 除去後の位置づけ

pytest から除去された F4 trial dataset は、  
削除・廃棄するものではなく、  
**Evaluation Artifacts** として引き続き保持する。

除去後の位置づけは以下のとおりとする。

- 評価・検証・考察のための参照データとして保持する
- pytest の合否判定や成功条件には一切関与させない
- pytest では、  
  trial dataset が **生成されたという事実** のみを  
  構造的に確認する

これにより、

- pytest は契約保証・成立確認に専念し
- trial dataset は評価資産として独立する

という責務分離が、  
**設計・実装の両面で固定される**。

---

本章の対応が完了することで、  
工程5における pytest 責務整理の中でも  
**最も影響範囲の大きい逸脱要因**が除去される。

---

## 8. 工程5における実装修正の実施と完了条件

本章は、工程5において実施される  
実装修正の内容と、その結果として  
**成立しているべき状態**を定義するものである。

ここで定義する事項は、  
「これから行う手順」や「推奨される作業順」ではなく、  
**工程5が完了したと判断するための到達点**を示す。

---

工程5完了時点において、  
以下のすべてが成立していること。

1. **削除対象テストが pytest から除外されていること**  
   工程4において削除対象として確定したテストが、  
   pytest の探索・実行対象から完全に除外されている。

2. **縮退対象テストから意味評価が除去されていること**  
   縮退対象とされたテストに含まれていた  
   応答内容の妥当性・十分性・差異を評価する assertion が除去され、  
   契約・成立・構造保証に限定された状態になっている。

3. **pytest 実行が契約・成立確認として安定していること**  
   pytest 実行が、  
   実行条件やナレッジ差分に過度に依存することなく、  
   契約保証基盤として一貫した挙動を示している。

4. **マーカー整理が完了していること**
   各テストに付与されたマーカーが、  
   工程5で定義した整理方針に沿って付け替えられており、  
   CI 実行構成が明確になっている。

これらの状態が同時に成立していることをもって、  
工程5における実装修正は完了したものと判断する。

---

本章により、  
工程5の完了は  
**作業実施の有無ではなく、状態の成立によって判断される**。

以降の章では、  
この完了状態を前提として、

- 管理系ドキュメントへの反映
- 工程5完了の明示

を行う。

---

## 9. 管理系ドキュメント更新（工程5の一部）

本章では、工程5において実施した実装修正を  
**プロジェクト管理上の事実として確定させるための更新作業**を定義する。

工程5は、  
テストコードの整理や pytest 構成の変更だけでは完了とならない。  
それらの変更が **公式な履歴および現在地として記録されていること**をもって、  
工程5は完結する。

---

### 9.1 CHANGELOG 更新

CHANGELOG.md には、  
工程5で実施した対応内容を記録する。

記載にあたっては、以下の方針を採用する。

- テストの削除・縮退・移動といった対応を  
  **pytest 責務整理の一環として記録**する
- 機能追加や仕様変更として誤解されないよう、  
  **「工程整理」「責務整理」による変更**であることを明示する
- 個別のテスト内容や assertion の詳細には踏み込まず、  
  工程5としての作業単位が把握できる粒度で記載する

CHANGELOG への反映は、  
工程5における実装修正が  
**意図したとおりに実施されたことを後続から追跡可能にする**  
ためのものである。

---

### 9.2 PROJECT_STATUS 更新

PROJECT_STATUS.md には、  
工程5の完了状態を明示的に反映する。

更新内容としては、以下を含める。

- テスト計画再構築Backlogにおける  
  **工程5が完了したことの明示**
- pytest を中心としたテスト工程環境が、  
  **整理後の正として成立している状態**に到達したことの記録
- 本プロジェクトが、  
  **通常の開発・検証フェーズへ復帰可能な状態**であることの明示

これにより、  
工程5は一時的な整理作業ではなく、  
**プロジェクト全体の状態遷移として完了した工程**として確定する。

---

本章の対応が完了することで、  
工程5における実装修正は、

- 実装面
- テスト構成面
- 管理・履歴面

のすべてにおいて反映された状態となる。

---

## 10. 工程5 完了条件チェックリスト（FIX）

本章では、工程5が完了したかどうかを判断するための  
**最終的な完了条件チェックリスト**を定義する。

工程5は、  
個々の作業が実施されたかどうかではなく、  
**本章に示すチェックリストがすべて完了状態になっているか**  
によって完了可否を判断する。

---

### ✅ 工程5 作業チェックリスト

- [ ] pytest マーカー付け替え  
  pytest に付与されるマーカーが、  
  工程5で定義した整理方針に沿って付け替えられている。

- [ ] F4 trial dataset の pytest 完全除去  
  trial dataset および関連する派生成果物が、  
  pytest の assertion 対象から完全に除去されている。

- [ ] 不要テストの削除 / 移動  
  削除対象テストが pytest から除外され、  
  移動対象の資産が適切な領域へ移設されている。

- [ ] CHANGELOG 更新  
  工程5におけるテスト責務整理・縮退・削除が、  
  CHANGELOG.md に工程整理として記録されている。

- [ ] PROJECT_STATUS 更新  
  PROJECT_STATUS.md において、  
  工程5が完了したことが明示されている。

---

**本チェックリストがすべて完了状態になっていることをもって、  
工程5は完了とする。**

本章は、  
工程5完了の判断基準であり、  
追加条件や補足判断を必要としない。

---

## 11. 工程5完了後の状態定義（本フェーズ復帰条件）

工程5が完了した時点で、  
本プロジェクトは以下の状態に到達している。

- pytest は、  
  契約・成立・構造保証を担う **契約保証基盤**として整理済みである  
- 回答内容の評価、意味判断、品質判断は、  
  pytest の責務から切り離され、  
  pytest 外の領域に明確に隔離されている
- テストスイート全体は、  
  工程5における実装修正を反映した  
  **「整理後の正」**として扱うことができる
- pytest 実行結果は、  
  評価判断を含まない基盤確認結果として  
  安定して解釈可能な状態にある

これにより、  
テスト計画再構築Backlogにおける一連の整理作業は終了し、  
本プロジェクトは  
**通常の開発・検証フェーズ**として以後の作業を進行できる状態に復帰する。

本書をもって、  
**工程5は完結し、テスト計画再構築Backlogから離脱する。**

以後、本ドキュメントは工程5の完了状態を説明する正本として参照される。

---
