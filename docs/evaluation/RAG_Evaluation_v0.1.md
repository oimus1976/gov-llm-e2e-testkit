# RAG 評価基準 v0.1

**（Markdown 変換による精度向上検証）**

## 1. 位置づけ（Why this document exists）

本評価基準は、
**HTML で記述された条例を Markdown に変換して RAG に登録することが、
限られた容量（20GB）制約下において RAG の精度向上に寄与するか**
を、**客観的かつ再現可能な方法で検証する**ことを目的とする。

本基準は **RAG 前処理（データ構造化）の有効性検証**に特化しており、
LLM 自体の性能評価や表現品質の評価は対象外とする。

---

## 2. スコープ（In Scope / Out of Scope）

### 2.1 評価対象（In Scope）

* HTML → Markdown 変換後の条例データ
* RAG による回答生成結果
* HTML 投入時と Markdown 投入時の **差分**

### 2.2 評価対象外（Out of Scope）

* 回答文の文体の自然さ
* 抽象的な説明の上手さ
* 一般知識としての正しさ
* LLM モデル間の性能差
* 同義語・意味理解レベルの高度評価（v0.1 では行わない）

---

## 3. 評価方針（Core Principle）

### 3.1 基本方針

評価は **絶対評価ではなく差分評価**とする。

> 「Markdown 化したことで *どれだけ良くなったか*」
> を測定対象とし、
> 単体での正答率や完成度を評価しない。

---

### 3.2 評価単位

* 1 テストケース =
  *1 質問 × 1 回答 × 1 RAG 構成（HTML / Markdown）*

* 同一質問を

  * HTML 投入構成
  * Markdown 投入構成
    で実行し、結果を比較する。

---

## 4. 評価指標（Metrics v0.1）

### 4.1 指標①：根拠出現率（Evidence Hit Rate）

#### 定義

回答文中に、**条例由来の一次情報が明示的に含まれているか**を評価する。

#### 具体例（条例 RAG における一次情報）

* 条文番号（例：「第○条」）
* 条例固有の制度名・用語
* 条例特有の定型表現
  （例：「〜しなければならない」「〜とする」）

#### 判定方法（v0.1）

* expected_keywords に条例由来語を定義
* 文字列一致で判定（意味解析は行わない）

#### 評価意図

Markdown 化によって：

* 条文構造が明確になり
* LLM が条例文を根拠として引用しやすくなる

という仮説を検証する。

---

### 4.2 指標②：無根拠回答率（Hallucination Rate）

#### 定義

条例に **直接根拠のない一般論・補足説明**が、
回答の主要部分を占めていないかを評価する。

#### 具体例（must_not_contain）

* 「一般的に」
* 「〜と言われています」
* 「参考までに」
* 「プライベート資料に該当情報が見当たらなかったため」

#### 判定方法（v0.1）

* must_not_contain に定義した語句が含まれていないこと
* 含まれていれば FAIL（または参考指標として記録）

#### 評価意図

Markdown 化によって：

* 「条例に無い話」をしにくくなるか
* 回答が条例文に引き寄せられるか

を測定する。

---

### 4.3 指標③：回答再現性（Answer Stability）

#### 定義

同一質問を複数回実行した際に、
**回答内容のばらつきが抑制されているか**を評価する。

#### 判定方法（v0.1）

* 同一質問を複数回実行
* expected_keywords の出現有無が安定しているかを確認
* 大きくブレる場合は再現性が低いと判断

#### 評価意図

Markdown による構造化が：

* 検索結果の一貫性
* 回答根拠の固定化

に寄与しているかを確認する。

---

## 5. 判定レベル（v0.1）

v0.1 では、以下の 3 段階のみを扱う。

| 判定      | 意味                                 |
| ------- | ---------------------------------- |
| PASS    | 評価指標を満たす                           |
| FAIL    | 評価指標を満たさない                         |
| SKIPPED | Answer Detection 不成立（Inconclusive） |

※ SKIPPED は失敗ではなく、評価不能を意味する。

---

## 6. v0.1 における意図的な制限

* 同義語判定は行わない
  （例：「食」≠「フルーツ」）
* 意味的類似度評価は行わない
* 自然言語処理による正規化は行わない

これらは **v0.2 以降の拡張対象**とする。

---

## 7. まとめ（Decision Record）

本評価基準 v0.1 は、

* Markdown 化の **効果検証**
* 容量制約下での **前処理価値の定量化**
* 将来の高度評価への **足場作り**

を目的とした、**最小かつ説明可能な評価基準**である。

---
