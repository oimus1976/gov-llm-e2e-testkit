---
spec_id: Spec_F9-A_Question_Set_and_Binding_v0.1r
title: F9-A Question Set and Ordinance Binding Specification
phase: F9-A
version: v0.1r
status: revised
previous_version: v0.1
fix_policy: fix-after-review
created_at: 2025-12-31
updated_at: 2025-12-31
authors:
  - Sumio Nishioka
  - ChatGPT (Architect Role)
related_docs:
  - PROJECT_STATUS.md
  - CHANGELOG.md
  - Responsibility_Map_v0.2.md
  - Roadmap.md
scope:
  - question_template
  - ordinance_binding
  - structural_resolution
out_of_scope:
  - answer_evaluation
  - semantic_interpretation
  - quality_judgement
---

# Spec_F9-A_Question_Set_and_Binding_v0.1r

## 1. 目的と位置づけ

F9 フェーズは「評価可能データを安定して提供する」ことを目的とする。  
F9-A はその入口として、**質問文と条例参照の対応関係を構造的に確定**し、  
後続フェーズ（F9-B / F9-D）に **曖昧さを一切含まない入力**を渡す責務を持つ。

本仕様は、以下を同時に満たすための設計を定義する。

- ゴールデン質問の汎用性を維持すること
- 条例が複数存在しても再現性を失わないこと
- 条・項の差異による評価不能状態を発生させないこと
- 一般職員による質問編集を可能にすること

---

## 2. 背景

従来のゴールデン質問は、汎用性を持たせるために、

- 「この条例は〜」
- 「第○条は〜」
- 「第○条第○項は〜」

といった抽象表現を含んでいた。

しかし、条例が複数になると、

- 「この条例」がどの条例を指すか不明確になる
- 条・項が条例ごとに異なるため一律に指定できない
- 人手解釈が混入し、評価可能性が損なわれる

といった問題が顕在化する。

F9-A はこれを解消するために、
**質問テンプレ・条例バインディング・実行用質問を分離**し、
構造的に一意な入力を生成する。

---

## 3. 用語定義

### 3.1 質問テンプレ（Question Template）

- 人間（職員）が編集する質問文
- 抽象表現（この条例／第○条／第○条第○項）でなければならない  
（具体的な条例ID・条番号・項番号を含めてはならない）
- 条例非依存である

### 3.2 質問セット（Question Set）

- 質問テンプレを集合として管理した単位
- 本仕様では **質問セットは1つのみ**定義する

### 3.3 条例バインディング（Ordinance Binding）

- 特定の条例IDに対して
- 各質問が参照すべき条・項を **確定値として保持**する対応表

### 3.4 実行用質問（Resolved Question）

- 条例ID・条番号・項番号がすべて解決済みの質問文
- answer.md / dataset に残る唯一の質問表現

### 3.5 条例データ（Ordinance Source）

- 職員が保有する条例本文（HTML / PDF / Word 等）
- 条・項探索における **唯一の一次資料**

---

## 4. 基本原則（FIX）

1. **質問セットは1つのみ定義する**
2. **条例ごとの差異はすべて条例バインディングで表現する**
3. **F9-A は条・項の探索・特定を行う**
4. **F9 実行時点で未解決の条・項を残さない**
5. **後続フェーズには解決済みの質問のみを渡す**

---

## 5. 質問テンプレ仕様

## CSV 質問セットフォーマット（A-0）

### 5.0 質問セット入力形式（CSV）

#### 5.0.1 目的

F9-A における質問テンプレは、
**一般職員が編集可能なファイル形式**で管理されることを前提とする。

そのため、本フェーズでは
**CSV（Excel 編集前提）**を
質問セットの正式な入力形式として採用する。

---

#### 5.0.2 採用理由（設計判断）

- 一般的な職員環境において
  **追加ツールなしで編集可能**
- 行＝質問、列＝属性という
  **直感的な構造**
- 編集ミスは A-1（質問テンプレ検証）で
  **確実に検出可能**
- YAML / JSON 等の構文エラーによる
  運用事故を回避できる

※ 文字コード（ANSI / UTF-8）や
Excel による自動加工は、
本フェーズの扱う内容では
**致命的な影響を与えない**と判断する。

---

#### 5.0.3 CSV ファイル仕様（確定）

##### ファイル形式

- 拡張子：`.csv`
- 区切り文字：カンマ（`,`）
- 文字コード：制限しない（実装側で吸収）
  - 実装では UTF-8 を前提とする

---

##### 列定義

| 列名            | 必須 | 内容               |
| ------------- | -- | ---------------- |
| `text`        | 必須 | 質問テンプレ本文         |
| `question_id` | 任意 | 質問識別子（並び順管理・参照用） |

※ 実行・解決処理において
`question_id` の有無は問わない。

---

##### 記述例

```csv
question_id,text
Q01,この条例は何を目的として制定されていますか。
Q02,第○条はどのような内容を定めていますか。
Q03,第○条第○項では何を規定していますか。
```

---

#### 5.0.4 記述ルール（重要）

- `text` 列には
  **抽象表現のみ**を記載すること
  - 「この条例」
  - 「第○条」
  - 「第○条第○項」
- 具体的な条例ID・条番号・項番号を
  **直接記載してはならない**
- 空行・コメント行は
  **無視されるものとする**

---

#### 5.0.5 F9-A における責務分離

CSV 質問セットの取り扱いにおいて：

- **A-0**
  - CSV を読み込み、
    質問テンプレ本文の配列を生成する
  - 内容の妥当性は検証しない
- **A-1**
  - 質問テンプレが
    抽象表現ルールに適合しているか検証する
- **A-2 以降**
  - 条例ID・条・項の解決を行う

CSV 読み込み段階では、
**質問内容の解釈・補正・推測は一切行わない。**

---

#### 5.0.6 完了条件

- 職員が CSV ファイルを編集し、
- そのファイルを F9-A に投入した際、
- A-1 によって
  **投入可否が機械的に判定できる状態**が成立していること。

---

### 5.1 管理単位

質問テンプレは「質問セット」として管理する。

例：SET_A（Q01〜Q18）

### 5.2 記述例

```csv
question_id,text
Q01,この条例は何を目的として制定されていますか。
Q02,第○条はどのような内容を定めていますか。
Q03,第○条第○項では何を規定していますか。

```

※ 本フェーズにおける質問テンプレの入力形式は CSV とする。  
※ YAML / JSON 等の構造化形式は、一般職員の編集負荷および
   運用事故リスクを考慮し、採用しない。

- CSV ファイルは A-0 によって読み込まれ、
質問テンプレ本文（text 列）の配列として A-1 に渡される。
- CSV 読み込み段階では、
質問内容の検証・解釈・補正は一切行わない。

### 5.3 制約

- 抽象表現の使用は許可する
- 条例ID・条番号・項番号を  
  **条例ごとに変動する前提で直接埋め込んではならない**

---

## 6. 条例バインディング仕様

### 6.1 管理単位

- 条例ID ごとに 1 バインディングを持つ
- 質問セットと 1:1 で対応する

### 6.2 記述例

```yaml
ordinance_id: k518RG00000022
question_set: SET_A

bindings:
  Q01:
    ordinance_id: k518RG00000022
  Q02:
    article: 3
  Q03:
    article: 4
    paragraph: 5
```

### 6.3 制約（FIX）

- article / paragraph は確定値のみ
- null / 未定義は禁止
- 条例データに基づき存在確認済みであること

---

## 7. 条・項の探索と確定（F9-A の責務）

### 7.1 位置づけ

F9-A は、条例ID が与えられた以上、
当該条例に存在する条・項を **必ず特定・確定するフェーズ**である。

条・項の探索は、

- 構造的事実の確定であり
- 回答内容の評価や意味解釈には該当しない

### 7.2 許可される処理

- 条例データから条番号を列挙する
- 条内の項構造を確認する
- 条・項の存在を確認し確定する

---

## 8. 解決保証ポリシー（FIX）

- F9-A は、条・項を未解決のまま後続フェーズへ渡してはならない

- 条・項が自動的に確定できない場合、  
  以下の手段を用いて **必ず解決を行う**
  - ユーザー（職員）に条・項の直接入力を促す
  - 条例データに基づく探索アルゴリズムを強化する
  - 補助的な索引・規則・前提情報を利用する
- いずれの場合も、  
  **解決された確定値のみが F9-B / F9-D に渡される**

---

## 9. 実行用質問の生成

### 9.1 生成ルール

- 質問テンプレ + 条例バインディング → 実行用質問
- 抽象表現はすべて解決される

### 9.2 生成例

```text
Q01: この条例（k518RG00000022）は何を目的として制定されていますか。
Q02: 第3条はどのような内容を定めていますか。
Q03: 第4条第5項では何を規定していますか。
```

---

## 10. 非目標（Out of Scope）

本仕様は以下を意図的に行わない。

- 条文内容の意味解釈
- 回答の正誤・品質評価
- 自然言語理解による推測
- 回答生成の最適化

---

## 11. まとめ

F9-A は、

- **質問と条例参照の構造を確定するフェーズ**
- **評価可能性を壊さないための前処理フェーズ**

であり、

- 回答の意味
- 回答の良し悪し

には一切関与しない。

---

## 12. FIX 要約

- 質問セットは1つ
- 条例ごとの差異はバインディングで吸収
- 条・項探索は F9-A の正当な責務
- 未解決状態は禁止
- 必ず解決して次へ渡す

---
